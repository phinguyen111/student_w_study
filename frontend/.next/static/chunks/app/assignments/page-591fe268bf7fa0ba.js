(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[947],{62898:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),a=(e,t)=>{let n=(0,r.forwardRef)(({color:n="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:o="",children:d,...u},m)=>(0,r.createElement)("svg",{ref:m,...s,width:a,height:a,stroke:n,strokeWidth:c?24*Number(l)/Number(a):l,className:["lucide",`lucide-${i(e)}`,o].join(" "),...u},[...t.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(d)?d:[d]]));return n.displayName=`${e}`,n}},11981:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},20173:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},81291:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},17158:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},6141:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},86264:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8957:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},82104:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},82549:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(62898).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},88354:function(e,t,n){Promise.resolve().then(n.bind(n,92774))},92774:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var r=n(57437),s=n(2265),i=n(57508),a=n(97729),l=n(24033),c=n(10826),o=n(27815),d=n(85754),u=n(8957),m=n(82549),h=n(20173),x=n(11981),g=n(82104),f=n(81291),b=n(86264),w=n(17158),p=n(35890);function v(e){let{assignmentId:t,questions:n,passingScore:i,showCorrectAnswers:l,onClose:v,onComplete:y}=e,[j,k]=(0,s.useState)(0),[N,E]=(0,s.useState)([]),[q,z]=(0,s.useState)(l),[_,S]=(0,s.useState)(0),[Z,L]=(0,s.useState)(!1),[C,R]=(0,s.useState)(null),[F,I]=(0,s.useState)(!1),D=(0,s.useRef)(null),A=(0,s.useRef)(!1),T=(0,s.useRef)(!1),M=(0,s.useRef)([]),{startTracking:O,endTracking:B,isTracking:V,sessionId:Q}=(0,p.O)({assignmentId:t,quizType:"assignment",onSessionStart:e=>{D.current=Date.now(),M.current=[],M.current.push({questionIndex:0,startTime:Date.now()})}}),{trackQuizAction:Y,trackButtonClick:P}=(0,a.B)();(0,s.useEffect)(()=>(!l&&t&&O(),()=>{V&&B()}),[t,l]),(0,s.useEffect)(()=>(!l&&t&&(D.current||(D.current=Date.now()),(async()=>{try{let e=document.documentElement;e.requestFullscreen?await e.requestFullscreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.mozRequestFullScreen?await e.mozRequestFullScreen():e.msRequestFullscreen&&await e.msRequestFullscreen()}catch(e){console.warn("Fullscreen request denied or not supported:",e.message),alert("⚠️ Cảnh b\xe1o: Quiz n\xe0y y\xeau cầu chế độ fullscreen để đảm bảo t\xednh to\xe0n vẹn.\n\nVui l\xf2ng bật fullscreen khi l\xe0m b\xe0i. Nếu bạn rời khỏi trang, chuyển tab, hoặc tho\xe1t fullscreen, quiz sẽ tự động kết th\xfac v\xe0 bạn kh\xf4ng thể l\xe0m lại.")}})()),()=>{let e=async()=>{try{document.fullscreenElement?await document.exitFullscreen():document.webkitFullscreenElement?await document.webkitExitFullscreen():document.mozFullScreenElement?await document.mozCancelFullScreen():document.msFullscreenElement&&await document.msExitFullscreen()}catch(e){console.error("Error exiting fullscreen:",e)}};(l||q)&&e()}),[t,l,q]),(0,s.useEffect)(()=>{l&&H().then(()=>{z(!0)})},[l,t]);let H=async()=>{try{var e,n,r;let s=await c.Z.get("/progress/quiz-assignments/".concat(t));if(null===(e=s.data.assignment)||void 0===e?void 0:e.latestResult){let e=s.data.assignment.latestResult;S(e.score),R(e);let t=e.answers.sort((e,t)=>e.questionIndex-t.questionIndex).map(e=>e.selectedAnswer);E(t)}else if((null===(r=s.data.assignment)||void 0===r?void 0:null===(n=r.previousResults)||void 0===n?void 0:n.length)>0){let e=s.data.assignment.previousResults[0];S(e.score),R(e);let t=e.answers.sort((e,t)=>e.questionIndex-t.questionIndex).map(e=>e.selectedAnswer);E(t)}}catch(e){console.error("Error fetching result:",e)}},$=e=>{if(l)return;let n=[...N];n[j]=e,E(n),Y("answer_select",t,void 0,{question_index:j,selected_answer:e})},W=()=>{let e=0;n.forEach((t,n)=>{N[n]===t.correctAnswer&&e++}),S(e/n.length*10),z(!0)},J=async()=>{L(!0);let e=M.current.find(e=>e.questionIndex===j&&!e.endTime);e&&(e.endTime=Date.now()),V&&await B(new Date);try{let e=D.current?Math.floor((Date.now()-D.current)/1e3):0,r=(await c.Z.post("/progress/quiz-assignments/".concat(t,"/submit"),{answers:N,timeTaken:e})).data.result;R(r),S(r.score),Y("submit",t,void 0,{quiz_type:"assignment",quiz_score:r.score,passed:r.passed,time_taken:e,questions_count:n.length,correct_answers:Math.round(r.score/10*n.length)}),y()}catch(e){var r,s;console.error("Error submitting quiz:",e),alert((null===(s=e.response)||void 0===s?void 0:null===(r=s.data)||void 0===r?void 0:r.message)||"Error submitting quiz")}finally{L(!1)}},U=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"user_choice";if(!A.current){A.current=!0,I(!0),Y("abandon",t,void 0,{abandon_reason:e,questions_answered:N.filter(e=>void 0!==e).length,time_spent:D.current?Math.floor((Date.now()-D.current)/1e3):0}),V&&await B();try{try{let n=JSON.stringify({reason:e});navigator.sendBeacon("".concat("http://localhost:5000/api","/api/progress/quiz-assignments/").concat(t,"/abandon"),n)}catch(e){console.log("sendBeacon failed, using regular API call")}await c.Z.post("/progress/quiz-assignments/".concat(t,"/abandon"),{reason:e}),v();let n="";"tab_switch"===e?n="Bạn đ\xe3 chuyển tab khi l\xe0m b\xe0i. B\xe0i quiz đ\xe3 bị kết th\xfac.\n\nVui l\xf2ng li\xean hệ admin để được cấp quyền l\xe0m lại.":"browser_leave"===e?n="Bạn đ\xe3 rời khỏi tr\xecnh duyệt khi l\xe0m b\xe0i. B\xe0i quiz đ\xe3 bị kết th\xfac.\n\nVui l\xf2ng li\xean hệ admin để được cấp quyền l\xe0m lại.":"tab_close"===e&&(n="Bạn đ\xe3 đ\xf3ng trang khi l\xe0m b\xe0i. B\xe0i quiz đ\xe3 bị kết th\xfac.\n\nVui l\xf2ng li\xean hệ admin để được cấp quyền l\xe0m lại."),n?setTimeout(()=>{alert(n),y()},300):y()}catch(e){console.error("Error abandoning quiz:",e),v(),setTimeout(()=>{alert("Quiz đ\xe3 bị kết th\xfac do bạn đ\xe3 rời khỏi trang. Vui l\xf2ng li\xean hệ admin để được cấp quyền l\xe0m lại."),y()},300)}finally{I(!1)}}};if((0,s.useEffect)(()=>{if(l||q)return;let e=null,n=null,r=null,s=()=>{q||l||A.current||(document.hidden?T.current||A.current||(T.current=!0,A.current=!0,U("tab_switch").catch(()=>{})):(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||l||q||A.current||T.current||(T.current=!0,A.current=!0,U("browser_leave").catch(()=>{})),e&&(clearTimeout(e),e=null),r&&(clearInterval(r),r=null)))},i=()=>{!q&&!l&&!A.current&&(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||l||q||A.current||T.current||(T.current=!0,A.current=!0,U("browser_leave").catch(()=>{})))},a=e=>{if(!q&&!l&&!A.current&&(e.preventDefault(),e.returnValue="Bạn đang l\xe0m quiz! Nếu bạn đ\xf3ng trang n\xe0y, quiz sẽ bị kết th\xfac v\xe0 bạn kh\xf4ng thể l\xe0m lại.",!T.current&&!A.current)){T.current=!0,A.current=!0;try{let e=JSON.stringify({reason:"tab_close"});navigator.sendBeacon("".concat("http://localhost:5000/api","/api/progress/quiz-assignments/").concat(t,"/abandon"),e)}catch(e){console.error("Error sending beacon:",e)}U("tab_close").catch(()=>{})}},c=()=>{q||l||A.current||(n=setTimeout(()=>{!document.hidden||T.current||A.current?document.hidden||setTimeout(()=>{!document.hidden||T.current||A.current||(T.current=!0,A.current=!0,U("browser_leave").catch(()=>{}))},1500):(T.current=!0,A.current=!0,U("browser_leave").catch(()=>{}))},150))},o=()=>{n&&(clearTimeout(n),n=null)};return document.addEventListener("visibilitychange",s),document.addEventListener("fullscreenchange",i),document.addEventListener("webkitfullscreenchange",i),document.addEventListener("mozfullscreenchange",i),document.addEventListener("MSFullscreenChange",i),window.addEventListener("beforeunload",a),window.addEventListener("blur",c),window.addEventListener("focus",o),()=>{e&&clearTimeout(e),n&&clearTimeout(n),r&&clearInterval(r),document.removeEventListener("visibilitychange",s),document.removeEventListener("fullscreenchange",i),document.removeEventListener("webkitfullscreenchange",i),document.removeEventListener("mozfullscreenchange",i),document.removeEventListener("MSFullscreenChange",i),window.removeEventListener("beforeunload",a),window.removeEventListener("blur",c),window.removeEventListener("focus",o)}},[q,l,t]),q||l){let e=_>=i,t=Math.round(_/10*n.length);return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in",children:(0,r.jsxs)(o.Zb,{className:"w-full max-w-3xl max-h-[90vh] shadow-2xl border-2 animate-in zoom-in-95 duration-200 flex flex-col",children:[(0,r.jsx)(o.Ol,{className:"border-b flex-shrink-0",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(o.ll,{className:"text-2xl flex items-center gap-2",children:[(0,r.jsx)(u.Z,{className:"h-6 w-6 ".concat(e?"text-yellow-500":"text-gray-400")}),"Quiz Results"]}),(0,r.jsx)(d.z,{variant:"ghost",size:"icon",onClick:v,children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})})]})}),(0,r.jsxs)(o.aY,{className:"pt-6 overflow-y-auto flex-1 min-h-0",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-32 h-32 rounded-full mb-4 ".concat(e?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"),children:(0,r.jsx)("div",{className:"text-5xl font-bold ".concat(e?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:_.toFixed(1)})}),(0,r.jsxs)("div",{className:"text-2xl font-bold mb-2 text-foreground",children:[_.toFixed(1),"/10"]}),(0,r.jsx)("div",{className:"flex items-center justify-center gap-2 mb-2 ".concat(e?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{className:"h-6 w-6"}),(0,r.jsx)("p",{className:"text-xl font-semibold",children:"Congratulations! You passed!"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{className:"h-6 w-6"}),(0,r.jsxs)("p",{className:"text-xl font-semibold",children:["You need at least ",i,"/10 to pass"]})]})}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["You got ",t," out of ",n.length," questions correct"]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Progress"}),(0,r.jsxs)("span",{className:"font-medium",children:[t,"/",n.length]})]}),(0,r.jsx)("div",{className:"w-full bg-muted rounded-full h-3 overflow-hidden",children:(0,r.jsx)("div",{className:"h-full transition-all duration-500 ".concat(e?"bg-green-500":"bg-red-500"),style:{width:"".concat(t/n.length*100,"%")}})})]}),(0,r.jsx)("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto pr-2 scrollbar-thin",children:n.map((e,t)=>{let n=N[t],s=n===e.correctAnswer;return(0,r.jsxs)("div",{className:"p-4 rounded-lg border-2 ".concat(s?"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20":"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/20"),children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[s?(0,r.jsx)(h.Z,{className:"h-5 w-5 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}):(0,r.jsx)(g.Z,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"font-semibold text-base flex-1",children:e.question})]}),(0,r.jsx)("div",{className:"space-y-2 ml-8",children:e.options.map((t,i)=>{let a="p-3 rounded-lg border-2 transition-all";return i===e.correctAnswer?a+=" border-green-500 bg-green-100 dark:bg-green-900/30 text-green-900 dark:text-green-100 font-medium":i!==n||s?a+=" border-border bg-background":a+=" border-red-500 bg-red-100 dark:bg-red-900/30 text-red-900 dark:text-red-100",(0,r.jsx)("div",{className:a,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i===e.correctAnswer&&(0,r.jsx)(h.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),i===n&&!s&&(0,r.jsx)(g.Z,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),(0,r.jsx)("span",{children:t})]})},i)})}),e.explanation&&(0,r.jsx)("div",{className:"mt-3 ml-8 p-3 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[(0,r.jsx)("strong",{children:"Explanation:"})," ",e.explanation]})})]},t)})}),(0,r.jsx)("div",{className:"flex-shrink-0 pt-4 border-t",children:(0,r.jsx)(d.z,{onClick:v,className:"w-full",size:"lg",children:"Close"})})]})]})})}let X=n[j];if(!X)return null;let G=void 0!==N[j],K=(j+1)/n.length*100;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in",children:(0,r.jsxs)(o.Zb,{className:"w-full max-w-3xl shadow-2xl border-2 animate-in zoom-in-95 duration-200",children:[(0,r.jsxs)(o.Ol,{className:"border-b",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)(o.ll,{className:"text-2xl",children:"Quiz"}),(0,r.jsx)(d.z,{variant:"ghost",size:"icon",onClick:v,children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)(o.SZ,{className:"text-base",children:["Question ",j+1," of ",n.length]}),(0,r.jsxs)("span",{className:"text-muted-foreground",children:[Math.round(K),"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-muted rounded-full h-2 overflow-hidden",children:(0,r.jsx)("div",{className:"bg-primary h-full transition-all duration-300",style:{width:"".concat(K,"%")}})})]})]}),(0,r.jsxs)(o.aY,{className:"pt-6",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold mb-6 leading-tight",children:X.question}),(0,r.jsx)("div",{className:"space-y-3",children:X.options.map((e,t)=>{let n=N[j]===t;return(0,r.jsx)("button",{onClick:()=>$(t),disabled:l,className:"w-full text-left p-4 rounded-lg border-2 transition-all duration-200 ".concat(l?"cursor-default opacity-60":n?"border-primary bg-primary/10 shadow-md scale-[1.02]":"border-border hover:border-primary/50 hover:bg-accent/50"),children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center ".concat(n?"border-primary bg-primary text-primary-foreground":"border-muted-foreground/30"),children:n&&(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-current"})}),(0,r.jsx)("span",{className:"text-base",children:e})]})},t)})})]}),(0,r.jsxs)("div",{className:"flex justify-between gap-4 pt-4 border-t",children:[(0,r.jsxs)(d.z,{variant:"outline",onClick:()=>{if(j>0){let e=M.current.find(e=>e.questionIndex===j&&!e.endTime);e&&(e.endTime=Date.now());let t=j-1;k(t),M.current.find(e=>e.questionIndex===t)||M.current.push({questionIndex:t,startTime:Date.now()})}},disabled:0===j,className:"flex items-center gap-2",children:[(0,r.jsx)(f.Z,{className:"h-4 w-4"}),"Previous"]}),(0,r.jsx)(d.z,{onClick:j===n.length-1?J:()=>{let e=M.current.find(e=>e.questionIndex===j&&!e.endTime);if(e&&(e.endTime=Date.now()),l)W();else if(j<n.length-1){let e=j+1;k(e),Y("question_view",t,void 0,{question_index:e}),M.current.push({questionIndex:e,startTime:Date.now()})}else W()},disabled:!G||Z||l,className:"flex items-center gap-2",size:"lg",children:l?(0,r.jsxs)(r.Fragment,{children:["View Results",(0,r.jsx)(h.Z,{className:"h-4 w-4"})]}):Z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 animate-spin"}),"Submitting..."]}):j===n.length-1?(0,r.jsxs)(r.Fragment,{children:["Submit Quiz",(0,r.jsx)(h.Z,{className:"h-4 w-4"})]}):(0,r.jsxs)(r.Fragment,{children:["Next",(0,r.jsx)(w.Z,{className:"h-4 w-4"})]})})]})]})]})})})}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,n(62898).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);var j=n(6141);function k(){let{isAuthenticated:e,loading:t}=(0,i.useAuth)(),n=(0,l.useRouter)(),[m,f]=(0,s.useState)([]),[w,p]=(0,s.useState)(!0),[k,N]=(0,s.useState)(null),[E,q]=(0,s.useState)(!1),{trackQuizAction:z,trackButtonClick:_,trackNavigation:S}=(0,a.B)();(0,s.useEffect)(()=>{t||e||n.push("/login")},[e,t,n]),(0,s.useEffect)(()=>{e&&Z()},[e]);let Z=async()=>{try{p(!0);let e=await c.Z.get("/progress/quiz-assignments");f(e.data.assignments||[]),S("","/assignments","direct")}catch(e){console.error("Error fetching assignments:",e)}finally{p(!1)}},L=async e=>{try{let t=(await c.Z.get("/progress/quiz-assignments/".concat(e))).data.assignment;N(t),q(!0),z("start",e,t.title,{quiz_type:"assignment",passing_score:t.passingScore,questions_count:t.questions.length}),_("Start Quiz","/assignments")}catch(e){var t,n;console.error("Error fetching assignment:",e),alert((null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)||"Error loading quiz")}};if(t||w)return(0,r.jsx)("div",{className:"container mx-auto px-4 py-16 flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(b.Z,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Loading..."})]})});let C=(null==k?void 0:k.questions.map(e=>({question:"string"==typeof e.question?e.question:e.question.en||e.question.vi||"",options:e.options.map(e=>"string"==typeof e?e:e.en||e.vi||""),correctAnswer:e.correctAnswer||0,explanation:e.explanation?"string"==typeof e.explanation?e.explanation:e.explanation.en||e.explanation.vi||"":void 0})))||[];return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[hsl(185_80%_98%)] via-[hsl(210_60%_98%)] to-[hsl(250_60%_98%)] dark:from-[hsl(220_30%_8%)] dark:via-[hsl(230_30%_10%)] dark:to-[hsl(240_30%_12%)]",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-2 bg-gradient-to-r from-[hsl(185_80%_45%)] via-[hsl(210_60%_55%)] to-[hsl(250_60%_55%)] bg-clip-text text-transparent",children:"Quiz Assignments"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Complete your assigned quizzes before the deadline"})]}),0===m.length?(0,r.jsx)(o.Zb,{children:(0,r.jsx)(o.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(y,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No Assignments"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"You don't have any quiz assignments yet."})]})})}):(0,r.jsx)("div",{className:"space-y-4",children:m.map(e=>{let t=new Date(e.deadline),n=Math.ceil((t.getTime()-Date.now())/864e5),s=n<=1&&!e.isSubmitted;return(0,r.jsx)(o.Zb,{className:"".concat(e.isExpired&&!e.isSubmitted?"opacity-75 border-red-300 dark:border-red-700":""," ").concat(s&&!e.isSubmitted?"border-orange-300 dark:border-orange-700 bg-orange-50/50 dark:bg-orange-950/20":""),children:(0,r.jsx)(o.Ol,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)(o.ll,{className:"flex items-center gap-2 mb-2",children:[e.title,e.isSubmitted&&(0,r.jsxs)("span",{className:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded flex items-center gap-1",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4"}),"Submitted"]}),e.isExpired&&!e.isSubmitted&&(0,r.jsxs)("span",{className:"text-xs px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded flex items-center gap-1",children:[(0,r.jsx)(g.Z,{className:"h-4 w-4"}),"Expired"]}),s&&!e.isSubmitted&&(0,r.jsxs)("span",{className:"text-xs px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded flex items-center gap-1",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4"}),"Due Soon"]})]}),(0,r.jsx)(o.SZ,{className:"mb-3",children:e.description}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4"}),"Deadline: ",t.toLocaleString()]}),!e.isExpired&&!e.isSubmitted&&(0,r.jsx)("span",{className:s?"text-orange-600 dark:text-orange-400 font-medium":"",children:n>0?"".concat(n," day").concat(n>1?"s":""," remaining"):"Due today"}),(0,r.jsxs)("span",{children:["Passing: ",e.passingScore,"/10"]}),(0,r.jsxs)("span",{children:[e.questions.length," questions"]}),(0,r.jsxs)("span",{children:["Assigned by: ",e.assignedBy.name]})]}),e.isSubmitted&&e.userResult&&(0,r.jsx)("div",{className:"mt-3 p-3 rounded-lg border-2 ".concat(e.userResult.passed?"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20":"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/20"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.userResult.passed?(0,r.jsx)(u.Z,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):(0,r.jsx)(g.Z,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-semibold",children:["Your Score: ",e.userResult.score.toFixed(1),"/10"]}),(0,r.jsx)("p",{className:"text-sm ".concat(e.userResult.passed?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:e.userResult.passed?"Passed!":"Failed (Need "+e.passingScore+"/10 to pass)"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Submitted: ",new Date(e.userResult.submittedAt).toLocaleString()]})]})]})})]}),(0,r.jsx)("div",{className:"ml-4",children:e.canSubmit?(0,r.jsx)(d.z,{onClick:()=>L(e._id),children:"Start Quiz"}):e.isExpired?(0,r.jsx)(d.z,{variant:"outline",onClick:()=>L(e._id),children:"View Quiz"}):e.isSubmitted?(0,r.jsx)(d.z,{variant:"outline",onClick:()=>L(e._id),children:"Review Results"}):null})]})})},e._id)})}),E&&k&&(0,r.jsx)(v,{assignmentId:k._id,questions:C,passingScore:k.passingScore,showCorrectAnswers:k.isSubmitted||k.isExpired,onComplete:()=>{q(!1),N(null),Z()},onClose:()=>{q(!1),N(null)}})]})})}},35890:function(e,t,n){"use strict";n.d(t,{O:function(){return a}});var r=n(2265),s=n(10826),i=n(57508);function a(e){let{assignmentId:t,lessonId:n,quizType:a,onSessionStart:l}=e,{isAuthenticated:c}=(0,i.useAuth)(),o=(0,r.useRef)(null),d=(0,r.useRef)(null),u=(0,r.useRef)(null),m=(0,r.useRef)(""),h=(0,r.useRef)(!0),x=(0,r.useRef)(!0),g=(0,r.useRef)([]),[f,b]=(0,r.useState)(!1);(0,r.useCallback)(e=>{try{if(!e)return"";return new URL(e).hostname.replace("www.","")}catch(t){return e}},[]);let w=(0,r.useCallback)(async(e,t,n)=>{if(c&&o.current)try{let r=t||window.location.href,i=n||("undefined"!=typeof document?document.title:""),a=Date.now();await s.Z.post("/quiz-tracking/track-event",{sessionId:o.current,action:e,url:r,title:i,currentUrl:r,timestamp:new Date(a).toISOString()}),g.current.push({url:r,timestamp:a,action:e})}catch(e){console.error("Error tracking event:",e)}},[c]),p=(0,r.useCallback)(async()=>{if(c)try{let e=await s.Z.post("/quiz-tracking/start",{assignmentId:t,lessonId:n,quizType:a});e.data.sessionId&&(o.current=e.data.sessionId,d.current=Date.now(),u.current=Date.now(),m.current=window.location.href,h.current=!0,x.current=!0,g.current=[],b(!0),l&&l(e.data.sessionId))}catch(e){console.error("Error starting quiz tracking:",e)}},[c,t,n,a,l]),v=(0,r.useCallback)(async e=>{if(c&&o.current)try{h.current&&x.current||await w("switch_back"),await s.Z.post("/quiz-tracking/end",{sessionId:o.current,submitTime:e?e.toISOString():new Date().toISOString()}),o.current=null,b(!1)}catch(e){console.error("Error ending quiz tracking:",e)}},[c,w]);return(0,r.useEffect)(()=>{if(!f||!c)return;let e=null,t="",n=()=>{let n=Date.now(),r=window.location.href,s=document.title,i=document.referrer;if(document.hidden)h.current&&(h.current=!1,e=n,t=r,u.current=n,w("switch_away",r,s));else if(!h.current&&e){h.current=!0;let a=r!==m.current,l=i&&i!==r&&i!==t;if(a||l){let e=i||r;try{if(i){let e=new URL(i);e.pathname,e.search}}catch(e){}w("switch_back",e,s)}else w("switch_back",r,s);m.current=r,u.current=n,e=null}};return document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}},[f,c,w]),(0,r.useEffect)(()=>{if(!f||!c)return;let e="",t=()=>{if(x.current){x.current=!1;let t=window.location.href;Date.now(),e=t,w("window_blur",t,document.title)}},n=()=>{if(!x.current){Date.now(),x.current=!0;let t=window.location.href,n=document.referrer,r=t.includes("/assignments")||t.includes("/lesson"),s=t!==m.current,i=n&&n!==t&&n!==e;(!r||s||i)&&(s||i)?w("switch_back",n||t,document.title):w("window_focus",t,document.title),m.current=t}};return window.addEventListener("blur",t),window.addEventListener("focus",n),()=>{window.removeEventListener("blur",t),window.removeEventListener("focus",n)}},[f,c,w]),(0,r.useEffect)(()=>{if(!f||!c)return;let e=()=>{document.hidden||w("switch_away",window.location.href,document.title),v()};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[f,c,w,v]),(0,r.useEffect)(()=>{if(!f||!c)return;let e=e=>{!h.current&&f&&o.current&&console.log("Clipboard activity detected while away from quiz")},t=e=>{f&&o.current&&console.log("Paste activity detected during quiz")},n=e=>{if(!f)return;let t=window.location.href,n=document.title;t!==m.current&&w("switch_away",t,n)},r=e=>{if(!f)return;let t=window.location.href,n=document.title,r=document.referrer;r&&r!==t&&r!==m.current?(w("switch_back",r,n),m.current=t):t!==m.current&&(w("switch_back",t,n),m.current=t)},s=setInterval(()=>{if(!f)return;let e=window.location.href,t=e.includes("/assignments")||e.includes("/lesson")||e.includes("/quiz")||e.includes("/code");e!==m.current&&h.current&&x.current&&(t?w("switch_back",e,document.title):w("switch_away",e,document.title),m.current=e)},2e3);return window.addEventListener("pagehide",n),window.addEventListener("pageshow",r),document.addEventListener("copy",e),document.addEventListener("paste",t),()=>{clearInterval(s),window.removeEventListener("pagehide",n),window.removeEventListener("pageshow",r),document.removeEventListener("copy",e),document.removeEventListener("paste",t)}},[f,c,w]),{startTracking:p,endTracking:v,isTracking:f,sessionId:o.current}}},96061:function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var r=n(57042);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=r.W,a=(e,t)=>n=>{var r;if((null==t?void 0:t.variants)==null)return i(e,null==n?void 0:n.class,null==n?void 0:n.className);let{variants:a,defaultVariants:l}=t,c=Object.keys(a).map(e=>{let t=null==n?void 0:n[e],r=null==l?void 0:l[e];if(null===t)return null;let i=s(t)||s(r);return a[e][i]}),o=n&&Object.entries(n).reduce((e,t)=>{let[n,r]=t;return void 0===r||(e[n]=r),e},{});return i(e,c,null==t?void 0:null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:n,className:r,...s}=t;return Object.entries(s).every(e=>{let[t,n]=e;return Array.isArray(n)?n.includes({...l,...o}[t]):({...l,...o})[t]===n})?[...e,n,r]:e},[]),null==n?void 0:n.class,null==n?void 0:n.className)}}},function(e){e.O(0,[267,35,971,938,744],function(){return e(e.s=88354)}),_N_E=e.O()}]);