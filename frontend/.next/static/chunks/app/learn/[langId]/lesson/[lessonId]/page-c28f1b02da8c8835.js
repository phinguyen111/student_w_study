(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[102],{75219:function(t,s,r){Promise.resolve().then(r.bind(r,95378))},95378:function(t,s,r){"use strict";r.r(s),r.d(s,{default:function(){return S}});var n=r(57437),a=r(2265),l=r(24033),i=r(61396),o=r.n(i),c=r(57508),d=r(10826),u=r(27815),m=r(85754),h=r(82515),x=r(57393),f=r(30513),p=r(6435),g=r(62442),v=r(56224);function b(t){let{content:s}=t,{theme:l}=(0,p.F)(),[i,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{d(!0),r.e(523).then(r.bind(r,4523)).then(t=>{h({dark:t.vscDarkPlus,light:t.oneLight})})},[]);let b=(t,s)=>{navigator.clipboard.writeText(t),o(s),setTimeout(()=>o(null),2e3)};if(!c||!u)return(0,n.jsx)("div",{className:"prose prose-lg dark:prose-invert max-w-none",children:(0,n.jsx)(x.UG,{children:s})});let j="dark"===l?u.dark:u.light;return(0,n.jsx)("div",{className:"markdown-content",children:(0,n.jsx)(x.UG,{components:{h1:t=>{var s;let{node:r,...a}=t;return(0,n.jsx)("h1",{id:null===(s=a.children)||void 0===s?void 0:s.toString().toLowerCase().replace(/\s+/g,"-"),className:"text-4xl font-bold mt-8 mb-4 text-foreground scroll-mt-20",...a})},h2:t=>{var s;let{node:r,...a}=t;return(0,n.jsx)("h2",{id:null===(s=a.children)||void 0===s?void 0:s.toString().toLowerCase().replace(/\s+/g,"-"),className:"text-3xl font-bold mt-6 mb-3 text-foreground scroll-mt-20 border-b border-border pb-2",...a})},h3:t=>{var s;let{node:r,...a}=t;return(0,n.jsx)("h3",{id:null===(s=a.children)||void 0===s?void 0:s.toString().toLowerCase().replace(/\s+/g,"-"),className:"text-2xl font-semibold mt-4 mb-2 text-foreground scroll-mt-20",...a})},h4:t=>{let{node:s,...r}=t;return(0,n.jsx)("h4",{className:"text-xl font-semibold mt-4 mb-2 text-foreground",...r})},h5:t=>{let{node:s,...r}=t;return(0,n.jsx)("h5",{className:"text-lg font-semibold mt-3 mb-2 text-foreground",...r})},h6:t=>{let{node:s,...r}=t;return(0,n.jsx)("h6",{className:"text-base font-semibold mt-2 mb-2 text-foreground",...r})},p:t=>{let{node:s,...r}=t;return(0,n.jsx)("p",{className:"text-base leading-7 mb-4 text-foreground",...r})},ul:t=>{let{node:s,...r}=t;return(0,n.jsx)("ul",{className:"list-disc ml-6 mb-4 space-y-2",...r})},ol:t=>{let{node:s,...r}=t;return(0,n.jsx)("ol",{className:"list-decimal ml-6 mb-4 space-y-2",...r})},li:t=>{let{node:s,...r}=t;return(0,n.jsx)("li",{className:"text-base leading-7 text-foreground",...r})},a:t=>{let{node:s,...r}=t;return(0,n.jsx)("a",{className:"text-primary underline hover:text-primary/80 transition-colors font-medium",target:"_blank",rel:"noopener noreferrer",...r})},code:t=>{let{node:s,inline:r,className:a,children:l,...o}=t,c=/language-(\w+)/.exec(a||""),d=String(l).replace(/\n$/,""),u="code-".concat(Math.random().toString(36).substr(2,9));return!r&&c?(0,n.jsxs)("div",{className:"relative my-6 group",children:[(0,n.jsx)("div",{className:"absolute top-3 right-3 z-10",children:(0,n.jsx)(m.z,{variant:"ghost",size:"sm",onClick:()=>b(d,u),className:"h-8 px-2 opacity-0 group-hover:opacity-100 transition-opacity",children:i===u?(0,n.jsx)(g.Z,{className:"h-3 w-3 text-green-500"}):(0,n.jsx)(v.Z,{className:"h-3 w-3"})})}),(0,n.jsx)(f.Z,{language:c[1],style:j,customStyle:{margin:0,borderRadius:"0.5rem",padding:"1.5rem",fontSize:"0.875rem",lineHeight:"1.5"},...o,children:d})]}):(0,n.jsx)("code",{className:"text-sm bg-muted px-1.5 py-0.5 rounded font-mono text-foreground",...o,children:l})},blockquote:t=>{let{node:s,...r}=t;return(0,n.jsx)("blockquote",{className:"border-l-4 border-primary pl-4 italic my-4 text-muted-foreground bg-muted/50 py-2 rounded-r",...r})},table:t=>{let{node:s,...r}=t;return(0,n.jsx)("div",{className:"overflow-x-auto my-6",children:(0,n.jsx)("table",{className:"min-w-full border-collapse border border-border rounded-lg",...r})})},thead:t=>{let{node:s,...r}=t;return(0,n.jsx)("thead",{className:"bg-muted",...r})},tbody:t=>{let{node:s,...r}=t;return(0,n.jsx)("tbody",{...r})},tr:t=>{let{node:s,...r}=t;return(0,n.jsx)("tr",{className:"border-b border-border hover:bg-muted/50 transition-colors",...r})},th:t=>{let{node:s,...r}=t;return(0,n.jsx)("th",{className:"border border-border px-4 py-2 text-left font-semibold text-foreground",...r})},td:t=>{let{node:s,...r}=t;return(0,n.jsx)("td",{className:"border border-border px-4 py-2 text-foreground",...r})},img:t=>{let{node:s,...r}=t;return(0,n.jsx)("img",{className:"rounded-lg my-6 shadow-lg max-w-full h-auto border border-border",...r})},hr:t=>{let{node:s,...r}=t;return(0,n.jsx)("hr",{className:"my-8 border-t border-border",...r})},strong:t=>{let{node:s,...r}=t;return(0,n.jsx)("strong",{className:"font-bold text-foreground",...r})},em:t=>{let{node:s,...r}=t;return(0,n.jsx)("em",{className:"italic",...r})}},children:s})})}var j=r(4969),w=r(97729),y=r(86264),N=r(9865),k=r(73067),C=r(92455);function S(){let t=(0,l.useParams)(),s=(0,l.useRouter)(),{isAuthenticated:r,loading:i}=(0,c.useAuth)(),[x,f]=(0,a.useState)(null),[p,g]=(0,a.useState)(!0),[S,_]=(0,a.useState)(!1),{startTracking:z,stopTracking:E}=(0,j.n)(),{trackLessonAction:T,trackQuizAction:I,trackButtonClick:Z}=(0,w.B)();(0,a.useEffect)(()=>{i||r||s.push("/login")},[r,i,s]),(0,a.useEffect)(()=>(r&&t.lessonId&&(L(),z()),()=>{E()}),[r,t.lessonId]);let L=async()=>{try{let s=(await d.Z.get("/lessons/".concat(t.lessonId,"?lang=en"))).data.lesson;f(s),s&&T("view",s._id,s.title)}catch(t){console.error("Error fetching lesson:",t)}finally{g(!1)}},q=async(s,r,n)=>{try{var a,l;await d.Z.post("/progress/quiz/".concat(t.lessonId),{quizScore:s,codeScore:void 0!==r?r:void 0,sessionId:n||void 0}),I("submit",Array.isArray(t.lessonId)?t.lessonId[0]:t.lessonId,null==x?void 0:x.title,{quiz_score:s,code_score:r,passed:s>=((null==x?void 0:null===(a=x.quiz)||void 0===a?void 0:a.passingScore)||7)}),s>=((null==x?void 0:null===(l=x.quiz)||void 0===l?void 0:l.passingScore)||7)&&T("complete",Array.isArray(t.lessonId)?t.lessonId[0]:t.lessonId,null==x?void 0:x.title,{quiz_score:s,code_score:r}),E()}catch(t){console.error("Error submitting quiz:",t)}},R=()=>{_(!0),I("start",Array.isArray(t.lessonId)?t.lessonId[0]:t.lessonId,null==x?void 0:x.title),Z("Start Quiz",window.location.pathname)};return i||p?(0,n.jsx)("div",{className:"container mx-auto px-4 py-16 flex items-center justify-center min-h-screen",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(y.Z,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),(0,n.jsx)("p",{className:"text-lg text-muted-foreground",children:"Loading lesson..."})]})}):x?(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[hsl(185_80%_98%)] via-[hsl(210_60%_98%)] to-[hsl(250_60%_98%)] dark:from-[hsl(220_30%_8%)] dark:via-[hsl(230_30%_10%)] dark:to-[hsl(240_30%_12%)]",children:(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[(0,n.jsxs)("nav",{className:"mb-6 flex items-center gap-2 text-sm text-muted-foreground",children:[(0,n.jsx)(o(),{href:"/learn",className:"hover:text-foreground transition-colors",children:"Learn"}),(0,n.jsx)("span",{children:"/"}),(0,n.jsx)(o(),{href:"/learn/".concat(t.langId),className:"hover:text-foreground transition-colors",children:"Language"}),(0,n.jsx)("span",{children:"/"}),(0,n.jsxs)(o(),{href:"/learn/".concat(t.langId,"/level/").concat(x.levelId._id),className:"hover:text-foreground transition-colors",children:["Level ",x.levelId.levelNumber]}),(0,n.jsx)("span",{children:"/"}),(0,n.jsx)("span",{className:"text-foreground font-medium",children:"Lesson"})]}),(0,n.jsx)(o(),{href:"/learn/".concat(t.langId,"/level/").concat(x.levelId._id),children:(0,n.jsxs)(m.z,{variant:"ghost",className:"mb-6",children:[(0,n.jsx)(k.Z,{className:"h-4 w-4 mr-2"}),"Back"]})}),(0,n.jsx)(u.Zb,{className:"mb-6 shadow-lg border-2",children:(0,n.jsx)(u.Ol,{className:"pb-4",children:(0,n.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(N.Z,{className:"h-5 w-5 text-primary"}),(0,n.jsxs)("span",{className:"text-sm font-medium text-primary",children:["Level ",x.levelId.levelNumber]})]}),(0,n.jsx)(u.ll,{className:"text-3xl md:text-4xl mb-2 leading-tight",children:x.title}),(0,n.jsx)(u.SZ,{className:"text-base",children:x.levelId.title})]})})})}),(0,n.jsx)(u.Zb,{className:"mb-6 shadow-lg",children:(0,n.jsxs)(u.aY,{className:"pt-6",children:[(0,n.jsx)("div",{className:"max-w-none",children:(0,n.jsx)(b,{content:x.content})}),x.codeExample&&(0,n.jsxs)("div",{className:"mt-8 pt-6 border-t",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,n.jsx)(C.Z,{className:"h-5 w-5 text-primary"}),(0,n.jsx)("h3",{className:"text-xl font-semibold",children:"Code Example"})]}),(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsx)("div",{className:"absolute top-3 right-3 z-10",children:(0,n.jsx)(m.z,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(x.codeExample||"")},className:"h-8 px-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,n.jsx)(v.Z,{className:"h-3 w-3"})})}),(0,n.jsx)(b,{content:"```html\n".concat(x.codeExample,"\n```")})]})]})]})}),(0,n.jsx)(u.Zb,{className:"shadow-lg border-2 border-primary/30 bg-gradient-to-br from-[hsl(185_80%_95%)] via-[hsl(210_60%_95%)] to-[hsl(250_60%_95%)] dark:from-[hsl(185_80%_15%)] dark:via-[hsl(210_60%_15%)] dark:to-[hsl(250_60%_15%)]",children:(0,n.jsxs)(u.aY,{className:"pt-6",children:[(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Ready to test your knowledge?"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose how you want to practice"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)(m.z,{onClick:R,size:"lg",variant:"default",className:"w-full h-24 flex flex-col items-center justify-center gap-2",children:[(0,n.jsx)(N.Z,{className:"h-6 w-6"}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Take Quiz"}),(0,n.jsxs)("div",{className:"text-xs opacity-90",children:[x.quiz.questions.length," questions"]})]})]}),(0,n.jsxs)(m.z,{onClick:()=>s.push("/learn/".concat(t.langId,"/lesson/").concat(t.lessonId,"/code")),size:"lg",variant:"outline",className:"w-full h-24 flex flex-col items-center justify-center gap-2 border-2",children:[(0,n.jsx)(C.Z,{className:"h-6 w-6"}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Code Exercise"}),(0,n.jsx)("div",{className:"text-xs opacity-90",children:"Practice coding"})]})]})]})]})}),S&&x.quiz.questions.length>0&&(0,n.jsx)(h.O,{questions:x.quiz.questions,passingScore:x.quiz.passingScore,lessonId:x._id,onComplete:q,onClose:()=>_(!1)})]})}):(0,n.jsx)("div",{className:"container mx-auto px-4 py-16 text-center min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(N.Z,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),(0,n.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Lesson not found"}),(0,n.jsx)("p",{className:"text-muted-foreground mb-4",children:"The lesson you're looking for doesn't exist."}),(0,n.jsx)(o(),{href:"/learn/".concat(t.langId),children:(0,n.jsx)(m.z,{children:"Go Back"})})]})})}},75539:function(t,s,r){"use strict";r.d(s,{p:function(){return p}});var n=r(57437),a=r(2265),l=r(55994),i=r(78616),o=r(53416),c=r(52515),d=r(88826),u=r(48262),m=r(6435);let h={html:(0,i.dy)(),javascript:(0,o.eJ)(),css:(0,c.iv)(),python:(0,o.eJ)()},x=u.tk.theme({"&":{backgroundColor:"#ffffff",color:"#333333"},".cm-content":{caretColor:"#333333"},".cm-focused .cm-cursor":{borderLeftColor:"#333333"},".cm-focused .cm-selectionBackground, .cm-selectionBackground":{backgroundColor:"#b3d4fc"},".cm-activeLine":{backgroundColor:"#f5f5f5"},".cm-gutters":{backgroundColor:"#f8f8f8",color:"#999999",border:"none",borderRight:"1px solid #e0e0e0"},".cm-lineNumbers .cm-gutterElement":{minWidth:"3ch",padding:"0 8px 0 8px"},".cm-foldGutter":{width:"14px"},".cm-scroller":{fontFamily:'Consolas, Monaco, "Courier New", monospace'}},{dark:!1}),f=u.tk.theme({"&":{backgroundColor:"#1e1e1e",color:"#d4d4d4"},".cm-content":{caretColor:"#d4d4d4"},".cm-focused .cm-cursor":{borderLeftColor:"#d4d4d4"},".cm-focused .cm-selectionBackground, .cm-selectionBackground":{backgroundColor:"#264f78"},".cm-activeLine":{backgroundColor:"#2a2d2e"},".cm-gutters":{backgroundColor:"#252526",color:"#858585",border:"none",borderRight:"1px solid #3e3e42"},".cm-lineNumbers .cm-gutterElement":{minWidth:"3ch",padding:"0 8px 0 8px"}},{dark:!0});function p(t){let{value:s,onChange:r,language:i,height:o="400px",placeholder:c="Write your code here...",readOnly:p=!1}=t,{theme:g}=(0,m.F)(),[v,b]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{b(!0)},[]),(0,a.useEffect)(()=>{v&&w("dark"===g)},[g,v]),!v)return(0,n.jsx)("div",{className:"w-full border rounded-lg bg-[hsl(220_40%_96%)] dark:bg-[hsl(220_30%_10%)] font-mono text-sm",style:{height:o,padding:"1rem"},children:(0,n.jsx)("div",{className:"text-muted-foreground",children:c})});let y=j?[d.vk,f]:[x];return(0,n.jsx)("div",{className:"relative border rounded-lg overflow-hidden shadow-sm",children:(0,n.jsx)(l.ZP,{value:s,height:o,theme:y,extensions:[h[i],u.tk.lineWrapping],onChange:r,placeholder:c,editable:!p,basicSetup:{lineNumbers:!0,highlightSelectionMatches:!0,foldGutter:!0,dropCursor:!1,allowMultipleSelections:!1,indentOnInput:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,highlightActiveLine:!0,searchKeymap:!0,lintKeymap:!0,foldKeymap:!0,completionKeymap:!0,defaultKeymap:!0,historyKeymap:!0,drawSelection:!0}})})}},82515:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{O:function(){return QuizModal}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(57437),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2265),_components_ui_card__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(27815),_components_ui_button__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(85754),_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(40110),_components_CodeEditor__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(75539),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8957),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(82549),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(20173),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(11981),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(82104),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(15432),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(94900),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(81291),_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(17158),_hooks_useQuizTracker__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(35890);function QuizModal(param){var _codeAnswers_currentQuestion,_codeAnswers_currentQuestion1,_codeAnswers_currentQuestion2,_currentCode_html,_currentCode_css,_question_options;let{questions,passingScore,lessonId,onComplete,onClose}=param,[currentQuestion,setCurrentQuestion]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[selectedAnswers,setSelectedAnswers]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[codeAnswers,setCodeAnswers]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[showResults,setShowResults]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[score,setScore]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[iframeKey,setIframeKey]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[previewOutput,setPreviewOutput]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(""),startTimeRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),questionTimesRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)([]),{startTracking,endTracking,isTracking,sessionId}=(0,_hooks_useQuizTracker__WEBPACK_IMPORTED_MODULE_6__.O)({lessonId:lessonId||void 0,quizType:"lesson",onSessionStart:t=>{startTimeRef.current=Date.now(),questionTimesRef.current=[],questionTimesRef.current.push({questionIndex:0,startTime:Date.now()})}});(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>(lessonId&&!isTracking&&startTracking(),()=>{isTracking&&endTracking()}),[lessonId,isTracking,startTracking,endTracking]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{setCodeAnswers(questions.map(t=>"code"===t.type&&t.starterCode?{html:t.starterCode.html||"",css:t.starterCode.css||"",javascript:t.starterCode.javascript||""}:{html:"",css:"",javascript:""}))},[questions]);let normalizedQuestions=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>questions.map((t,s)=>{if("code"===t.type)return t;let r=[];return 0===s&&console.log("Original question options:",t.options,"Type:",typeof t.options,"IsArray:",Array.isArray(t.options)),Array.isArray(t.options)?r=t.options.map((t,s)=>{if("string"==typeof t)return t;if(t&&"object"==typeof t){let s=t,r=s.en||s.vi;if(r)return String(r);for(let t in s)if("_id"!==t&&"__v"!==t&&"string"==typeof s[t]&&s[t])return String(s[t]);return JSON.stringify(t)}return String(t)}):t.options&&"object"==typeof t.options&&(r=Object.keys(t.options).filter(t=>!isNaN(Number(t))&&"_id"!==t&&"__v"!==t).map(Number).sort((t,s)=>t-s).map(s=>{let r=t.options[s];if("string"==typeof r)return r;if(r&&"object"==typeof r){let t=r,s=t.en||t.vi;if(s)return String(s);for(let s in t)if("_id"!==s&&"__v"!==s&&"string"==typeof t[s]&&t[s])return String(t[s]);return JSON.stringify(r)}return String(r)})),0===s&&console.log("Normalized options:",r),{...t,type:t.type||"multiple-choice",options:r}}),[questions]),handleCodeChange=(t,s)=>{let r=[...codeAnswers];r[currentQuestion]||(r[currentQuestion]={html:"",css:"",javascript:""}),r[currentQuestion]={...r[currentQuestion],[t]:s},setCodeAnswers(r)},handleResetCode=()=>{let t=normalizedQuestions[currentQuestion];if("code"===t.type&&t.starterCode){let s=[...codeAnswers];s[currentQuestion]={html:t.starterCode.html||"",css:t.starterCode.css||"",javascript:t.starterCode.javascript||""},setCodeAnswers(s),setPreviewOutput("")}},handleRunCode=()=>{let question=normalizedQuestions[currentQuestion];if("code"===question.type){let code=codeAnswers[currentQuestion]||{html:"",css:"",javascript:""};if("javascript"===question.codeType)try{let result=eval(code.javascript||"");void 0!==result?setPreviewOutput(String(result)):setPreviewOutput("Code executed successfully!")}catch(error){setPreviewOutput("Error: ".concat(error.message))}else setPreviewOutput("Code ready for preview!"),setIframeKey(t=>t+1)}},handleAnswerSelect=t=>{let s=[...selectedAnswers];s[currentQuestion]=t,setSelectedAnswers(s)},handleNext=()=>{let t=questionTimesRef.current.find(t=>t.questionIndex===currentQuestion&&!t.endTime);if(t&&(t.endTime=Date.now()),setPreviewOutput(""),setIframeKey(0),currentQuestion<normalizedQuestions.length-1){let t=currentQuestion+1;setCurrentQuestion(t),questionTimesRef.current.push({questionIndex:t,startTime:Date.now()})}else calculateScore()},handlePrevious=()=>{if(currentQuestion>0){let t=questionTimesRef.current.find(t=>t.questionIndex===currentQuestion&&!t.endTime);t&&(t.endTime=Date.now()),setPreviewOutput(""),setIframeKey(0);let s=currentQuestion-1;setCurrentQuestion(s),questionTimesRef.current.find(t=>t.questionIndex===s)||questionTimesRef.current.push({questionIndex:s,startTime:Date.now()})}},calculateScore=()=>{let t=questionTimesRef.current.find(t=>t.questionIndex===currentQuestion&&!t.endTime);t&&(t.endTime=Date.now());let s=0;normalizedQuestions.forEach((t,r)=>{if("code"===t.type){let t=codeAnswers[r]||{html:"",css:"",javascript:""};(t.html||t.css||t.javascript)&&s++}else selectedAnswers[r]===t.correctAnswer&&s++}),setScore(s/normalizedQuestions.length*10),setShowResults(!0)},handleSubmit=async()=>{isTracking&&await endTracking(new Date),startTimeRef.current&&(Date.now(),startTimeRef.current),onComplete(score,void 0,sessionId||void 0),onClose()},handleClose=async()=>{isTracking&&!showResults&&await endTracking(),onClose()};if(showResults){let passed=score>=passingScore,correctCount=Math.round(score/10*normalizedQuestions.length);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.Zb,{className:"w-full max-w-3xl max-h-[90vh] shadow-2xl border-2 animate-in zoom-in-95 duration-200 flex flex-col",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.Ol,{className:"border-b flex-shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center justify-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.ll,{className:"text-2xl flex items-center gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_7__.Z,{className:"h-6 w-6 ".concat(passed?"text-yellow-500":"text-gray-400")}),"Quiz Results"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{variant:"ghost",size:"icon",onClick:handleClose,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_8__.Z,{className:"h-4 w-4"})})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.aY,{className:"pt-6 overflow-y-auto flex-1 min-h-0",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-center mb-6",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"inline-flex items-center justify-center w-32 h-32 rounded-full mb-4 ".concat(passed?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-5xl font-bold ".concat(passed?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:score.toFixed(1)})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-2xl font-bold mb-2 text-foreground",children:[score.toFixed(1),"/10"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex items-center justify-center gap-2 mb-2 ".concat(passed?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:passed?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_9__.Z,{className:"h-6 w-6"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"text-xl font-semibold",children:"Congratulations! You passed!"})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_10__.Z,{className:"h-6 w-6"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"text-xl font-semibold",children:["You need at least ",passingScore,"/10 to pass"]})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"text-muted-foreground",children:["You got ",correctCount," out of ",normalizedQuestions.length," questions correct"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-muted-foreground",children:"Progress"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"font-medium",children:[correctCount,"/",normalizedQuestions.length]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"w-full bg-muted rounded-full h-3 overflow-hidden",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"h-full transition-all duration-500 ".concat(passed?"bg-green-500":"bg-red-500"),style:{width:"".concat(correctCount/normalizedQuestions.length*100,"%")}})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"space-y-3 mb-4 max-h-96 overflow-y-auto pr-2 scrollbar-thin",children:normalizedQuestions.map((t,s)=>{var r,n,a,l;let i="code"===t.type,o=selectedAnswers[s],c=i?!!((null===(r=codeAnswers[s])||void 0===r?void 0:r.html)||(null===(n=codeAnswers[s])||void 0===n?void 0:n.css)||(null===(a=codeAnswers[s])||void 0===a?void 0:a.javascript)):o===t.correctAnswer,d=codeAnswers[s]||{html:"",css:"",javascript:""};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"p-4 rounded-lg border-2 ".concat(c?"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20":"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/20"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[c?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_9__.Z,{className:"h-5 w-5 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_11__.Z,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"font-semibold text-base flex-1",children:t.question})]}),i?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"ml-8 space-y-3",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Your Code:"}),(d.html||"html"===t.codeType||"html-css-js"===t.codeType)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-xs font-medium text-muted-foreground",children:"HTML:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"p-3 bg-muted rounded-lg border font-mono text-xs overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"whitespace-pre-wrap",children:d.html||"(empty)"})})]}),(d.css||"css"===t.codeType||"html-css-js"===t.codeType)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-xs font-medium text-muted-foreground",children:"CSS:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"p-3 bg-muted rounded-lg border font-mono text-xs overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"whitespace-pre-wrap",children:d.css||"(empty)"})})]}),(d.javascript||"javascript"===t.codeType||"html-css-js"===t.codeType)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-xs font-medium text-muted-foreground",children:"JavaScript:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"p-3 bg-muted rounded-lg border font-mono text-xs overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"whitespace-pre-wrap",children:d.javascript||"(empty)"})})]})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"space-y-2 ml-8",children:null===(l=t.options)||void 0===l?void 0:l.map((s,r)=>{let n="string"==typeof s?s:s&&"object"==typeof s&&("en"in s||"vi"in s)&&(s.en||s.vi)||String(s),a="p-3 rounded-lg border-2 transition-all";return r===t.correctAnswer?a+=" border-green-500 bg-green-100 dark:bg-green-900/30 text-green-900 dark:text-green-100 font-medium":r!==o||c?a+=" border-border bg-background":a+=" border-red-500 bg-red-100 dark:bg-red-900/30 text-red-900 dark:text-red-100",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:a,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center gap-2",children:[r===t.correctAnswer&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_9__.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),r===o&&!c&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_11__.Z,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{children:n})]})},r)})}),t.explanation&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mt-3 ml-8 p-3 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("strong",{children:"Explanation:"})," ",t.explanation]})})]},s)})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex-shrink-0 pt-4 border-t",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{onClick:handleSubmit,className:"w-full",size:"lg",children:"Continue Learning"})})]})]})})}let question=normalizedQuestions[currentQuestion];if(!question||"code"!==question.type&&(!question.options||0===question.options.length))return null;let isCodeQuestion="code"===question.type,hasAnswer=isCodeQuestion?!!((null===(_codeAnswers_currentQuestion=codeAnswers[currentQuestion])||void 0===_codeAnswers_currentQuestion?void 0:_codeAnswers_currentQuestion.html)||(null===(_codeAnswers_currentQuestion1=codeAnswers[currentQuestion])||void 0===_codeAnswers_currentQuestion1?void 0:_codeAnswers_currentQuestion1.css)||(null===(_codeAnswers_currentQuestion2=codeAnswers[currentQuestion])||void 0===_codeAnswers_currentQuestion2?void 0:_codeAnswers_currentQuestion2.javascript)):void 0!==selectedAnswers[currentQuestion],progress=(currentQuestion+1)/normalizedQuestions.length*100,currentCode=codeAnswers[currentQuestion]||{html:"",css:"",javascript:""};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.Zb,{className:"w-full max-w-4xl max-h-[90vh] shadow-2xl border-2 animate-in zoom-in-95 duration-200 flex flex-col",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.Ol,{className:"border-b flex-shrink-0",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.ll,{className:"text-2xl",children:"Quiz"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{variant:"ghost",size:"icon",onClick:onClose,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_8__.Z,{className:"h-4 w-4"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.SZ,{className:"text-base",children:["Question ",currentQuestion+1," of ",normalizedQuestions.length]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"text-muted-foreground",children:[Math.round(progress),"%"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"w-full bg-muted rounded-full h-2 overflow-hidden",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-primary h-full transition-all duration-300",style:{width:"".concat(progress,"%")}})})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_card__WEBPACK_IMPORTED_MODULE_2__.aY,{className:"pt-6 overflow-y-auto flex-1 min-h-0",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"mb-8",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-2xl font-bold mb-6 leading-tight",children:question.question}),isCodeQuestion?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-4",children:["html-css-js"===question.codeType&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.mQ,{defaultValue:"html",className:"w-full",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.dr,{className:"grid w-full grid-cols-3",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.SP,{value:"html",children:"HTML"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.SP,{value:"css",children:"CSS"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.SP,{value:"javascript",children:"JS"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.nU,{value:"html",className:"mt-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center justify-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-sm font-medium",children:"HTML Code"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{variant:"outline",size:"sm",onClick:handleResetCode,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_12__.Z,{className:"h-4 w-4 mr-2"}),"Reset"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_CodeEditor__WEBPACK_IMPORTED_MODULE_5__.p,{value:currentCode.html||"",onChange:t=>handleCodeChange("html",t),language:"html",height:"300px",placeholder:"Write your HTML code here..."})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.nU,{value:"css",className:"mt-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center justify-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-sm font-medium",children:"CSS Code"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{variant:"outline",size:"sm",onClick:handleResetCode,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_12__.Z,{className:"h-4 w-4 mr-2"}),"Reset"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_CodeEditor__WEBPACK_IMPORTED_MODULE_5__.p,{value:currentCode.css||"",onChange:t=>handleCodeChange("css",t),language:"css",height:"300px",placeholder:"Write your CSS code here..."})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_tabs__WEBPACK_IMPORTED_MODULE_4__.nU,{value:"javascript",className:"mt-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center justify-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-sm font-medium",children:"JavaScript Code"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{variant:"outline",size:"sm",onClick:handleResetCode,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_12__.Z,{className:"h-4 w-4 mr-2"}),"Reset"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_CodeEditor__WEBPACK_IMPORTED_MODULE_5__.p,{value:currentCode.javascript||"",onChange:t=>handleCodeChange("javascript",t),language:"javascript",height:"300px",placeholder:"Write your JavaScript code here..."})]})})]}),question.codeType&&"html-css-js"!==question.codeType&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center justify-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"text-sm font-medium",children:["html"===question.codeType?"HTML":"css"===question.codeType?"CSS":"JavaScript"," Code"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{variant:"outline",size:"sm",onClick:handleResetCode,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_12__.Z,{className:"h-4 w-4 mr-2"}),"Reset"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_CodeEditor__WEBPACK_IMPORTED_MODULE_5__.p,{value:"html"===question.codeType?currentCode.html||"":"css"===question.codeType?currentCode.css||"":currentCode.javascript||"",onChange:t=>{"html"===question.codeType?handleCodeChange("html",t):"css"===question.codeType?handleCodeChange("css",t):handleCodeChange("javascript",t)},language:question.codeType,height:"300px",placeholder:"Write your ".concat(question.codeType.toUpperCase()," code here...")})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{onClick:handleRunCode,variant:"outline",className:"w-full",size:"lg",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_13__.Z,{className:"h-4 w-4 mr-2"}),"Run Code"]}),previewOutput&&"javascript"===question.codeType&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h4",{className:"font-semibold text-sm",children:"Output:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"p-4 bg-muted rounded-lg border",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"whitespace-pre-wrap text-sm",children:previewOutput})})]}),("html"===question.codeType||"css"===question.codeType||"html-css-js"===question.codeType)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h4",{className:"font-semibold text-sm",children:"Preview:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"border rounded-lg overflow-hidden bg-white dark:bg-[hsl(220_30%_8%)]",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("iframe",{onLoad:t=>{var s;let r=t.currentTarget,n=r.contentDocument||(null===(s=r.contentWindow)||void 0===s?void 0:s.document);if(n){if(n.open(),"html"===question.codeType||"html-css-js"===question.codeType){let t=currentCode.html||"",s="html-css-js"===question.codeType&&currentCode.css||"";n.write("\n                                <!DOCTYPE html>\n                                <html>\n                                <head>\n                                  ".concat(s?"<style>".concat(s,"</style>"):"","\n                                </head>\n                                <body>\n                                  ").concat(t,"\n                                  ").concat(currentCode.javascript?"<script>".concat(currentCode.javascript,"</script>"):"","\n                                </body>\n                                </html>\n                              "))}else"css"===question.codeType&&n.write("\n                                <!DOCTYPE html>\n                                <html>\n                                <head>\n                                  <style>".concat(currentCode.css||"",'</style>\n                                </head>\n                                <body>\n                                  <div class="demo-container">\n                                    <h1>CSS Demo</h1>\n                                    <p>This is a paragraph styled with your CSS.</p>\n                                    <div class="box">Box Element</div>\n                                    <button>Button Element</button>\n                                  </div>\n                                </body>\n                                </html>\n                              '));n.close()}},className:"w-full h-96 border-0",sandbox:"allow-scripts allow-same-origin",title:"Code Output"},"".concat(iframeKey,"-").concat((null===(_currentCode_html=currentCode.html)||void 0===_currentCode_html?void 0:_currentCode_html.length)||0,"-").concat((null===(_currentCode_css=currentCode.css)||void 0===_currentCode_css?void 0:_currentCode_css.length)||0))})]})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"space-y-3",children:null===(_question_options=question.options)||void 0===_question_options?void 0:_question_options.map((t,s)=>{let r="string"==typeof t?t:t&&"object"==typeof t&&("en"in t||"vi"in t)&&(t.en||t.vi)||String(t),n=selectedAnswers[currentQuestion]===s;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:()=>handleAnswerSelect(s),className:"w-full text-left p-4 rounded-lg border-2 transition-all duration-200 ".concat(n?"border-primary bg-primary/10 shadow-md scale-[1.02]":"border-border hover:border-primary/50 hover:bg-accent/50"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center gap-3",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center ".concat(n?"border-primary bg-primary text-primary-foreground":"border-muted-foreground/30"),children:n&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"w-3 h-3 rounded-full bg-current"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-base",children:r})]})},s)})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex justify-between gap-4 pt-4 border-t",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{variant:"outline",onClick:handlePrevious,disabled:0===currentQuestion,className:"flex items-center gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_14__.Z,{className:"h-4 w-4"}),"Previous"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.z,{onClick:handleNext,disabled:!hasAnswer,className:"flex items-center gap-2",size:"lg",children:currentQuestion===normalizedQuestions.length-1?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:["Submit Quiz",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_9__.Z,{className:"h-4 w-4"})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:["Next",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_AlertCircle_CheckCircle2_ChevronLeft_ChevronRight_Play_RotateCcw_Trophy_X_XCircle_lucide_react__WEBPACK_IMPORTED_MODULE_15__.Z,{className:"h-4 w-4"})]})})]})]})]})})}},40110:function(t,s,r){"use strict";r.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return o},nU:function(){return u}});var n=r(57437),a=r(2265),l=r(56570),i=r(1657);let o=l.fC,c=a.forwardRef((t,s)=>{let{className:r,...a}=t;return(0,n.jsx)(l.aV,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...a})});c.displayName=l.aV.displayName;let d=a.forwardRef((t,s)=>{let{className:r,...a}=t;return(0,n.jsx)(l.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...a})});d.displayName=l.xz.displayName;let u=a.forwardRef((t,s)=>{let{className:r,...a}=t;return(0,n.jsx)(l.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...a})});u.displayName=l.VY.displayName},35890:function(t,s,r){"use strict";r.d(s,{O:function(){return i}});var n=r(2265),a=r(10826),l=r(57508);function i(t){let{assignmentId:s,lessonId:r,quizType:i,onSessionStart:o}=t,{isAuthenticated:c}=(0,l.useAuth)(),d=(0,n.useRef)(null),u=(0,n.useRef)(null),m=(0,n.useRef)(null),h=(0,n.useRef)(""),x=(0,n.useRef)(!0),f=(0,n.useRef)(!0),p=(0,n.useRef)([]),[g,v]=(0,n.useState)(!1);(0,n.useCallback)(t=>{try{if(!t)return"";return new URL(t).hostname.replace("www.","")}catch(s){return t}},[]);let b=(0,n.useCallback)(async(t,s,r)=>{if(c&&d.current)try{let n=s||window.location.href,l=r||("undefined"!=typeof document?document.title:""),i=Date.now();await a.Z.post("/quiz-tracking/track-event",{sessionId:d.current,action:t,url:n,title:l,currentUrl:n,timestamp:new Date(i).toISOString()}),p.current.push({url:n,timestamp:i,action:t})}catch(t){console.error("Error tracking event:",t)}},[c]),j=(0,n.useCallback)(async()=>{if(c)try{let t=await a.Z.post("/quiz-tracking/start",{assignmentId:s,lessonId:r,quizType:i});t.data.sessionId&&(d.current=t.data.sessionId,u.current=Date.now(),m.current=Date.now(),h.current=window.location.href,x.current=!0,f.current=!0,p.current=[],v(!0),o&&o(t.data.sessionId))}catch(t){console.error("Error starting quiz tracking:",t)}},[c,s,r,i,o]),w=(0,n.useCallback)(async t=>{if(c&&d.current)try{x.current&&f.current||await b("switch_back"),await a.Z.post("/quiz-tracking/end",{sessionId:d.current,submitTime:t?t.toISOString():new Date().toISOString()}),d.current=null,v(!1)}catch(t){console.error("Error ending quiz tracking:",t)}},[c,b]);return(0,n.useEffect)(()=>{if(!g||!c)return;let t=null,s="",r=()=>{let r=Date.now(),n=window.location.href,a=document.title,l=document.referrer;if(document.hidden)x.current&&(x.current=!1,t=r,s=n,m.current=r,b("switch_away",n,a));else if(!x.current&&t){x.current=!0;let i=n!==h.current,o=l&&l!==n&&l!==s;if(i||o){let t=l||n,s="";try{if(l){let t=new URL(l);s=t.pathname+t.search}}catch(t){}b("switch_back",t,a)}else b("switch_back",n,a);h.current=n,m.current=r,t=null}};return document.addEventListener("visibilitychange",r),()=>{document.removeEventListener("visibilitychange",r)}},[g,c,b]),(0,n.useEffect)(()=>{if(!g||!c)return;let t=null,s="",r=()=>{if(f.current){f.current=!1;let r=window.location.href;t=Date.now(),s=r,b("window_blur",r,document.title)}},n=()=>{if(!f.current){Date.now(),f.current=!0;let t=window.location.href,r=document.referrer,n=t.includes("/assignments")||t.includes("/lesson"),a=t!==h.current,l=r&&r!==t&&r!==s;(!n||a||l)&&(a||l)?b("switch_back",r||t,document.title):b("window_focus",t,document.title),h.current=t}};return window.addEventListener("blur",r),window.addEventListener("focus",n),()=>{window.removeEventListener("blur",r),window.removeEventListener("focus",n)}},[g,c,b]),(0,n.useEffect)(()=>{if(!g||!c)return;let t=()=>{document.hidden||b("switch_away",window.location.href,document.title),w()};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[g,c,b,w]),(0,n.useEffect)(()=>{if(!g||!c)return;let t=t=>{!x.current&&g&&d.current&&console.log("Clipboard activity detected while away from quiz")},s=t=>{g&&d.current&&console.log("Paste activity detected during quiz")},r=t=>{if(!g)return;let s=window.location.href,r=document.title;s!==h.current&&b("switch_away",s,r)},n=t=>{if(!g)return;let s=window.location.href,r=document.title,n=document.referrer;n&&n!==s&&n!==h.current?(b("switch_back",n,r),h.current=s):s!==h.current&&(b("switch_back",s,r),h.current=s)},a=setInterval(()=>{if(!g)return;let t=window.location.href,s=t.includes("/assignments")||t.includes("/lesson")||t.includes("/quiz")||t.includes("/code");t!==h.current&&x.current&&f.current&&(s?b("switch_back",t,document.title):b("switch_away",t,document.title),h.current=t)},2e3);return window.addEventListener("pagehide",r),window.addEventListener("pageshow",n),document.addEventListener("copy",t),document.addEventListener("paste",s),()=>{clearInterval(a),window.removeEventListener("pagehide",r),window.removeEventListener("pageshow",n),document.removeEventListener("copy",t),document.removeEventListener("paste",s)}},[g,c,b]),{startTracking:j,endTracking:w,isTracking:g,sessionId:d.current}}},4969:function(t,s,r){"use strict";r.d(s,{n:function(){return i}});var n=r(2265),a=r(10826),l=r(57508);function i(){let t=(0,n.useRef)(null),s=(0,n.useRef)(null),{isAuthenticated:r}=(0,l.useAuth)(),i=()=>{r&&(t.current=Date.now(),s.current=setInterval(async()=>{if(t.current&&Math.floor((Date.now()-t.current)/6e4)>0)try{await a.Z.post("/progress/time",{minutes:1}),t.current=Date.now()}catch(t){console.error("Error updating study time:",t)}},6e4))},o=async()=>{if(s.current&&(clearInterval(s.current),s.current=null),t.current&&r){let s=Math.floor((Date.now()-t.current)/6e4);if(s>0)try{await a.Z.post("/progress/time",{minutes:s})}catch(t){console.error("Error updating study time:",t)}t.current=null}};return(0,n.useEffect)(()=>()=>{o()},[]),{startTracking:i,stopTracking:o}}}},function(t){var s=function(s){return t(t.s=s)};t.O(0,[401,267,634,294,245,904,35,971,938,744],function(){return s(75219)}),_N_E=t.O()}]);